---

# This compose file acts as an example on using docker volumes for nagios
# configuration. As nagios configurations are different for each site they are
# not concidered part of the container image. The best way to deal with the
# configurations is to store them in a volume allowing the user to upgrade the
# image without the need to extract the site configuration from the container.

version: '3'
services:
  nagios:
    image: jasonrivers/nagios:latest
    volumes:
      - ./nagios/conf.d:/opt/nagios/etc/conf.d:ro
      - nagiosetc:/opt/nagios/etc
      - nagiosvar:/opt/nagios/var
      - customplugins:/opt/Custom-Nagios-Plugins
      - nagiosgraphvar:/opt/nagiosgraph/var
      - nagiosgraphetc:/opt/nagiosgraph/etc
    ports:
      - 80:80
    networks:
      - nagios-net    

  nrpe-vm1:
    image: totem/docker-nrpe:latest
    # image: mikenowak/nrpe:latest # co the su dung image nay,nhung config khac
    volumes:
      - /:/mnt/ROOT:ro
      - ./nrpe/nrpe.d/vm1.cfg:/etc/nagios/nrpe.d/vm1.cfg:ro
    privileged: true
    ports:
      - 5666:5666
    networks:
      - nagios-net

volumes:
    nagiosetc:
    nagiosvar:
    customplugins:
    nagiosgraphvar:
    nagiosgraphetc:

networks:
  nagios-net:      
